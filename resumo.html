<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Resumo ‚Äì Passageiro 5 Estrelas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="./theme/theme.css">

<style>
/* ===== PALETA 5 ESTRELAS ===== */
:root{
  --wine-dark:#2B0F14;
  --wine:#4A1A22;
  --gold:#C9A24D;
  --gold-soft:#E6C97A;
  --bg:#f4f1f2;
  --text:#2a2a2a;
}

/* ===== BASE ===== */
body{
  margin:0;
  min-height:100vh;
  background:
    linear-gradient(
      180deg,
      #ffffff 0%,
      #f4f1f2 60%,
      #efe9eb 100%
    );
  font-family:Inter, Arial, sans-serif;
  color:var(--text);
}

.page{
  min-height:100vh;
  display:flex;
  justify-content:center;
  padding:20px;
}

.container{
  width:100%;
  max-width:420px;
  display:flex;
  flex-direction:column;
  gap:18px;
}

/* ===== HEADER ===== */
.header{
  text-align:center;
  padding:22px;
  border-radius:24px;
  background:
    linear-gradient(
      135deg,
      var(--wine-dark),
      var(--wine)
    );
  box-shadow:0 14px 36px rgba(0,0,0,.22);
  color:#fff;
}

.header h1{
  font-size:1.3rem;
  font-weight:800;
  letter-spacing:2px;
}

.header .stars{
  margin:8px 0 6px;
  color:var(--gold);
  letter-spacing:4px;
  font-size:.95rem;
}

/* ===== BLOCOS ===== */
.block{
  background:#fff;
  border-radius:20px;
  padding:16px;
  box-shadow:0 8px 22px rgba(0,0,0,.1);
}

.route{
  font-size:.9rem;
  line-height:1.5;
}

.option{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px;
  border-radius:14px;
  border:1px solid #eee;
  margin-bottom:8px;
}

.details div{
  display:flex;
  justify-content:space-between;
  font-size:.85rem;
  margin-bottom:6px;
}

/* ===== TOTAL ===== */
.totalBox{
  background:
    linear-gradient(
      135deg,
      var(--wine-dark),
      var(--wine)
    );
  color:#fff;
  border-radius:22px;
  padding:18px;
  text-align:center;
  box-shadow:0 14px 36px rgba(0,0,0,.22);
}

.totalBox .label{
  font-size:.8rem;
  opacity:.9;
}

.total{
  font-size:2.3rem;
  font-weight:900;
  color:var(--gold);
}

/* ===== INPUTS ===== */
input, select{
  width:100%;
  padding:12px;
  border-radius:14px;
  border:1px solid #ccc;
}

/* ===== BOT√ïES ===== */
.btn-main{
  padding:16px;
  border-radius:18px;
  border:none;
  background:linear-gradient(180deg,var(--gold-soft),var(--gold));
  font-weight:900;
  cursor:pointer;
}

.btn-back{
  padding:14px;
  border-radius:16px;
  border:1px solid #ccc;
  background:#fff;
}

/* ===== ASSINATURA ===== */
.signature{
  background:#fff;
  border-radius:18px;
  padding:14px;
  font-size:.85rem;
  box-shadow:0 6px 18px rgba(0,0,0,.08);
}
</style>
</head>

<body>

<div class="page">
<div class="container">

  <!-- HEADER -->
  <div class="header">
    <h1>RESUMO DA CORRIDA</h1>
    <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
  </div>

  <!-- ROTA -->
  <div class="block route">
    <strong>üìç Origem</strong><br>
    <span id="origemTxt"></span><br><br>
    <strong>üèÅ Destino</strong><br>
    <span id="destinoTxt"></span>
  </div>

  <!-- TIPO -->
  <div class="block">
    <label>üöñ Tipo de viagem</label>
    <select id="tipoViagem">
      <option value="ida">Ida</option>
      <option value="bate_volta">Bate e volta (+80%)</option>
      <option value="ida_volta">Ida e volta (x2)</option>
      <option value="ida_volta_espera">Ida e volta + espera</option>
    </select>
  </div>

  <!-- TAXAS -->
  <div class="block">
    <div class="option"><span>üõ£Ô∏è Desvio simples</span><input type="checkbox" id="desvioSimples"></div>
    <div class="option"><span>üèñÔ∏è Volta da praia</span><input type="checkbox" id="voltaPraia"></div>
    <div class="option"><span>üß∫ Taxa de feira</span><input type="checkbox" id="taxaFeira"></div>
  </div>

  <!-- ANIMAL -->
  <div class="block">
    <label>üê∂ Transporte de animal</label>
    <select id="animal">
      <option value="0">N√£o</option>
      <option value="5">Pequeno</option>
      <option value="7">M√©dio</option>
      <option value="10">Grande</option>
      <option value="20">Viagem longa</option>
    </select>
  </div>

  <!-- ESPERA -->
  <div class="block">
    <label>‚è±Ô∏è Tempo de espera (min)</label>
    <input type="number" id="tempoEspera" placeholder="Ex: 8">
  </div>

  <!-- EXTRA -->
  <div class="block">
    <label>‚ûï Desvio adicional</label>
    <input type="number" id="desvioExtra" placeholder="Ex: 15.00">
  </div>

  <!-- DETALHES -->
  <div class="block">
    <strong>Detalhamento</strong>
    <div class="details" id="detalhamento"></div>
  </div>

  <!-- TOTAL -->
  <div class="totalBox">
    <div class="label">Valor total da corrida</div>
    <div class="total" id="total">R$ 0,00</div>
  </div>

  <!-- ASSINATURA -->
  <div class="signature" id="assinatura"></div>

  <button id="btnWhats" class="btn-main">Enviar no WhatsApp</button>
  <button class="btn-back" onclick="App.go('destino.html')">Voltar</button>

</div>
</div>

<script src="core/motoristas.js"></script>
<script src="core/global.js"></script>
<script src="core/taxas.js"></script>
<script src="core/dinamico.js"></script>

<script>
const usuario = JSON.parse(localStorage.getItem("usuarioRF"));
const origem = App.get("origem");
const destino = App.get("destino");
const valorBase = Number(App.get("valorBase")||0);

origemTxt.innerText = origem;
destinoTxt.innerText = destino;

const assinatura = document.getElementById("assinatura");
const btnWhats = document.getElementById("btnWhats");

if(usuario.tipo==="motorista"){
  assinatura.innerHTML=
    `<strong>MOTORISTA</strong><br>${usuario.nome}<br>
     Ve√≠culo: ${usuario.modelo}<br>
     Placa: ${usuario.placa}`;
}else{
  assinatura.style.display="none";
  btnWhats.style.display="none";
}

/* ===== ELEMENTOS ===== */
const tipoViagem = document.getElementById("tipoViagem");
const desvioSimples = document.getElementById("desvioSimples");
const voltaPraia = document.getElementById("voltaPraia");
const taxaFeira = document.getElementById("taxaFeira");
const animalSel = document.getElementById("animal");
const tempoEsperaInput = document.getElementById("tempoEspera");
const desvioExtraInput = document.getElementById("desvioExtra");

const detalhamento = document.getElementById("detalhamento");
const totalDiv = document.getElementById("total");

function calcular(){
  let total = valorBase;
  let detalhes = [];

  detalhes.push(`Base: R$ ${valorBase.toFixed(2)}`);

  if(tipoViagem.value!=="ida"){
    const v =
      tipoViagem.value==="bate_volta"?valorBase*0.8:
      tipoViagem.value==="ida_volta"?valorBase:
      valorBase*1.2;
    total+=v;
    detalhes.push(`Tipo de viagem: +R$ ${v.toFixed(2)}`);
  }

  if(desvioSimples.checked){ total+=Taxas.desvioRotaSimples; detalhes.push(`Desvio: +R$ ${Taxas.desvioRotaSimples.toFixed(2)}`); }
  if(voltaPraia.checked){ total+=Taxas.voltaPraia; detalhes.push(`Praia: +R$ ${Taxas.voltaPraia.toFixed(2)}`); }
  if(taxaFeira.checked){ total+=Taxas.feira; detalhes.push(`Feira: +R$ ${Taxas.feira.toFixed(2)}`); }

  const animal = Number(animalSel.value||0);
  if(animal){ total+=animal; detalhes.push(`Animal: +R$ ${animal.toFixed(2)}`); }

  const minutos = Number(tempoEsperaInput.value||0);
  if(minutos>=5){
    const espera = 3 + (minutos-5)*0.6;
    total+=espera;
    detalhes.push(`Espera: +R$ ${espera.toFixed(2)}`);
  }

  const extra = Number(desvioExtraInput.value||0);
  if(extra){ total+=extra; detalhes.push(`Extra: +R$ ${extra.toFixed(2)}`); }

  detalhamento.innerHTML = detalhes.map(d=>`<div>${d}</div>`).join("");
  totalDiv.innerText = `R$ ${total.toFixed(2)}`;
  App.set("total", total);
  window.__whatsDetalhes = detalhes;
}

document.querySelectorAll("input,select").forEach(e=>e.addEventListener("change",calcular));
calcular();
</script>

</body>
</html>
